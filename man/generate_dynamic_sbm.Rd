% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SBM.R
\name{generate_dynamic_sbm}
\alias{generate_dynamic_sbm}
\title{Generate a Dynamic Stochastic Block Model (SBM)}
\usage{
generate_dynamic_sbm(
  n,
  K,
  Z,
  B,
  new_B,
  theta = NULL,
  T = 10,
  persistence = 0.1,
  start_time,
  end_time = start_time,
  theta_fluctuate = TRUE,
  theta_spread_change = NULL,
  theta_spread_blocks = NULL,
  merge_communities = FALSE,
  split_community = FALSE,
  split_within = 0.2,
  split_between = 0.15,
  seed = NULL
)
}
\arguments{
\item{n}{Integer. Number of nodes.}

\item{K}{Integer. Number of communities at initialization.}

\item{Z}{Numeric matrix of size \eqn{n \times K}. Initial block membership
matrix (rows are one-hot vectors).}

\item{B}{Numeric \eqn{K \times K} matrix. Baseline block connection probabilities.}

\item{new_B}{Numeric \eqn{K \times K} matrix. Block connection probabilities
to use during changepoint periods.}

\item{theta}{Optional numeric vector of length \eqn{n}. Degree correction
parameters. If supplied, generates a DCSBM.}

\item{T}{Integer. Number of time steps to simulate.}

\item{persistence}{Numeric in \link{0,1}. Probability that a node changes its
community label at each time step during a changepoint.}

\item{start_time}{Integer. First time step of the changepoint.}

\item{end_time}{Integer. Last time step of the changepoint. Defaults to
\code{start_time}.}

\item{theta_fluctuate}{Logical. If TRUE, node degree parameters fluctuate
randomly over time.}

\item{theta_spread_change}{Optional numeric. If provided, widens the range
of \code{theta} for specified communities during a changepoint.}

\item{theta_spread_blocks}{Optional integer vector. Community indices to
which \code{theta_spread_change} is applied.}

\item{merge_communities}{Logical. If TRUE, all communities are merged into
a single community at \code{start_time}.}

\item{split_community}{Logical. If TRUE, community 1 is split into two
subcommunities at \code{start_time}.}

\item{split_within}{Numeric. Probability of edges within new subcommunities
after a split.}

\item{split_between}{Numeric. Probability of edges between new subcommunities
after a split.}

\item{seed}{Optional integer. Random seed for reproducibility.}
}
\value{
A list with two elements:
\itemize{
\item \code{adj_list} – List of adjacency matrices (length \code{T}).
\item \code{Z_list} – List of membership matrices (length \code{T}).
}
}
\description{
Simulates a sequence of adjacency matrices over time under a dynamic SBM or
dynamic degree-corrected SBM (DCSBM). Supports structural changes such as
changepoints, community merging, and community splitting.
}
\examples{
# Example: dynamic SBM with local changepoint
n <- 10; K <- 2; T <- 20
Z <- matrix(0, n, K)
Z[1:(n/2), 1] <- 1
Z[(n/2+1):n, 2] <- 1

B <- matrix(c(0.3, 0.1,
              0.1, 0.3), nrow = K, byrow = TRUE)
new_B <- B; new_B[1,1] <- 0.5

sim <- generate_dynamic_sbm(
  n = n, K = K, Z = Z,
  B = B, new_B = new_B,
  T = T, start_time = 10, end_time = 20,
  persistence = 0, theta_fluctuate = FALSE
)

length(sim$adj_list)  # 20 adjacency matrices

}
